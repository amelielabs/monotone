open interval 10, storage default(compression 1)
# test: merge memtable
insert 1
insert 2
insert 3
insert 5
partition 0
service  0
min      0
max      10
storage  default
memtable_a
  count  4
  size   52
memtable_b
  count  0
  size   0
mmap     0
file     0
compact 0
# test: validate
partition 0
service  0
min      0
max      10
storage  default
memtable_a
  count  0
  size   0
memtable_b
  count  0
  size   0
mmap     0
file     46
index
  size              135
  size_total        46
  size_total_origin 92
  count             1
  count_total       4
  lsn_max           0
  compression       1
  region
    offset          0
    size            46
    count           4
    min             1
    max             5
files default
00000000000000000000
00000000000000000000.index
region 0 0
region (index)
  offset 0
  size   46
  count  4
  min    1
  max    5
1, 2, 3, 5
# test: select (no key)
select
[1]
[2]
[3]
[5]
(eof)
# test: select (min)
select 0
[1]
[2]
[3]
[5]
(eof)
# test: select (point-lookup)
select 2
[2]
[3]
[5]
(eof)
# test: select (next after)
select 4
[5]
(eof)
# test: select (out-of-range)
select 6
(eof)
select 12
(eof)
# test: replace by key
insert 0 x
insert 3 x
memtable 0
memtable_a (2)
0, 3
memtable_b (0)

# test: select
select
[0, x]
[1]
[2]
[3, x]
[5]
(eof)
select 0
[0, x]
[1]
[2]
[3, x]
[5]
(eof)
select 2
[2]
[3, x]
[5]
(eof)
select 4
[5]
(eof)
select 6
(eof)
select 12
(eof)
# test: merge
partition 0
service  0
min      0
max      10
storage  default
memtable_a
  count  2
  size   28
memtable_b
  count  0
  size   0
mmap     0
file     46
index
  size              135
  size_total        46
  size_total_origin 92
  count             1
  count_total       4
  lsn_max           0
  compression       1
  region
    offset          0
    size            46
    count           4
    min             1
    max             5
compact 0
partition 0
service  0
min      0
max      10
storage  default
memtable_a
  count  0
  size   0
memtable_b
  count  0
  size   0
mmap     0
file     60
index
  size              136
  size_total        60
  size_total_origin 111
  count             1
  count_total       5
  lsn_max           0
  compression       1
  region
    offset          0
    size            60
    count           5
    min             0
    max             5
region 0 0
region (index)
  offset 0
  size   60
  count  5
  min    0
  max    5
0, 1, 2, 3, 5
# test: select
select
[0, x]
[1]
[2]
[3, x]
[5]
(eof)
select 0
[0, x]
[1]
[2]
[3, x]
[5]
(eof)
select 2
[2]
[3, x]
[5]
(eof)
select 4
[5]
(eof)
select 6
(eof)
select 12
(eof)
# test: update by cursor
stats
stats
  lsn                0
  rows_written       6
  rows_written_bytes 80
  storages           1
default
  partitions         1
  pending            0
  min                0
  max                10
  rows               5
  rows_cached        0
  size               60
  size_uncompressed  111
  size_cached        0
cursor c 2
update_by c 2 y
cursor_close c
stats
stats
  lsn                0
  rows_written       7
  rows_written_bytes 94
  storages           1
default
  partitions         1
  pending            0
  min                0
  max                10
  rows               6
  rows_cached        1
  size               74
  size_uncompressed  111
  size_cached        14
partition 0
service  0
min      0
max      10
storage  default
memtable_a
  count  1
  size   14
memtable_b
  count  0
  size   0
mmap     0
file     60
index
  size              136
  size_total        60
  size_total_origin 111
  count             1
  count_total       5
  lsn_max           0
  compression       1
  region
    offset          0
    size            60
    count           5
    min             0
    max             5
# test: select
select
[0, x]
[1]
[2, y]
[3, x]
[5]
(eof)
select 0
[0, x]
[1]
[2, y]
[3, x]
[5]
(eof)
select 2
[2, y]
[3, x]
[5]
(eof)
select 4
[5]
(eof)
select 6
(eof)
select 12
(eof)
# test: merge
partition 0
service  0
min      0
max      10
storage  default
memtable_a
  count  1
  size   14
memtable_b
  count  0
  size   0
mmap     0
file     60
index
  size              136
  size_total        60
  size_total_origin 111
  count             1
  count_total       5
  lsn_max           0
  compression       1
  region
    offset          0
    size            60
    count           5
    min             0
    max             5
compact 0
partition 0
service  0
min      0
max      10
storage  default
memtable_a
  count  0
  size   0
memtable_b
  count  0
  size   0
mmap     0
file     65
index
  size              136
  size_total        65
  size_total_origin 112
  count             1
  count_total       5
  lsn_max           0
  compression       1
  region
    offset          0
    size            65
    count           5
    min             0
    max             5
region 0 0
region (index)
  offset 0
  size   65
  count  5
  min    0
  max    5
0, 1, 2, 3, 5
# test: select
select
[0, x]
[1]
[2, y]
[3, x]
[5]
(eof)
select 0
[0, x]
[1]
[2, y]
[3, x]
[5]
(eof)
select 2
[2, y]
[3, x]
[5]
(eof)
select 4
[5]
(eof)
select 6
(eof)
select 12
(eof)
# test: delete by key
delete 0
delete 1
partition 0
service  0
min      0
max      10
storage  default
memtable_a
  count  2
  size   26
memtable_b
  count  0
  size   0
mmap     0
file     65
index
  size              136
  size_total        65
  size_total_origin 112
  count             1
  count_total       5
  lsn_max           0
  compression       1
  region
    offset          0
    size            65
    count           5
    min             0
    max             5
# test: select
select
[2, y]
[3, x]
[5]
(eof)
select 0
[2, y]
[3, x]
[5]
(eof)
select 2
[2, y]
[3, x]
[5]
(eof)
select 4
[5]
(eof)
select 6
(eof)
select 12
(eof)
# test: merge
partition 0
service  0
min      0
max      10
storage  default
memtable_a
  count  2
  size   26
memtable_b
  count  0
  size   0
mmap     0
file     65
index
  size              136
  size_total        65
  size_total_origin 112
  count             1
  count_total       5
  lsn_max           0
  compression       1
  region
    offset          0
    size            65
    count           5
    min             0
    max             5
compact 0
partition 0
service  0
min      0
max      10
storage  default
memtable_a
  count  0
  size   0
memtable_b
  count  0
  size   0
mmap     0
file     51
index
  size              136
  size_total        51
  size_total_origin 77
  count             1
  count_total       3
  lsn_max           0
  compression       1
  region
    offset          0
    size            51
    count           3
    min             2
    max             5
region 0 0
region (index)
  offset 0
  size   51
  count  3
  min    2
  max    5
2, 3, 5
# test: select
select
[2, y]
[3, x]
[5]
(eof)
select 0
[2, y]
[3, x]
[5]
(eof)
select 2
[2, y]
[3, x]
[5]
(eof)
select 4
[5]
(eof)
select 6
(eof)
select 12
(eof)
# test: delete by cursor
stats
stats
  lsn                0
  rows_written       9
  rows_written_bytes 120
  storages           1
default
  partitions         1
  pending            0
  min                0
  max                10
  rows               3
  rows_cached        0
  size               51
  size_uncompressed  77
  size_cached        0
cursor c 2
delete_by c
cursor_close c
stats
stats
  lsn                0
  rows_written       10
  rows_written_bytes 134
  storages           1
default
  partitions         1
  pending            0
  min                0
  max                10
  rows               4
  rows_cached        1
  size               65
  size_uncompressed  77
  size_cached        14
partition 0
service  0
min      0
max      10
storage  default
memtable_a
  count  1
  size   14
memtable_b
  count  0
  size   0
mmap     0
file     51
index
  size              136
  size_total        51
  size_total_origin 77
  count             1
  count_total       3
  lsn_max           0
  compression       1
  region
    offset          0
    size            51
    count           3
    min             2
    max             5
# test: select
select
[3, x]
[5]
(eof)
select 0
[3, x]
[5]
(eof)
select 2
[3, x]
[5]
(eof)
select 4
[5]
(eof)
select 6
(eof)
select 12
(eof)
# test: merge
partition 0
service  0
min      0
max      10
storage  default
memtable_a
  count  1
  size   14
memtable_b
  count  0
  size   0
mmap     0
file     51
index
  size              136
  size_total        51
  size_total_origin 77
  count             1
  count_total       3
  lsn_max           0
  compression       1
  region
    offset          0
    size            51
    count           3
    min             2
    max             5
compact 0
partition 0
service  0
min      0
max      10
storage  default
memtable_a
  count  0
  size   0
memtable_b
  count  0
  size   0
mmap     0
file     37
index
  size              136
  size_total        37
  size_total_origin 59
  count             1
  count_total       2
  lsn_max           0
  compression       1
  region
    offset          0
    size            37
    count           2
    min             3
    max             5
region 0 0
region (index)
  offset 0
  size   37
  count  2
  min    3
  max    5
3, 5
# test: select
select
[3, x]
[5]
(eof)
select 0
[3, x]
[5]
(eof)
select 2
[3, x]
[5]
(eof)
select 4
[5]
(eof)
select 6
(eof)
select 12
(eof)
close
