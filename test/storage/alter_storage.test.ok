init
set workers to 0
set interval to 10
set serial to false
set uuid to '00000000-0000-0000-0000-000000000000'
open
# test: alter storage parsing
alter
error: ALTER <STORAGE|PIPELINE> expected
alter storage
error: ALTER STORAGE <name> expected
alter storage if
error: IF <EXISTS> expected
alter storage if abc
error: IF <EXISTS> expected
alter storage if not abc
error: IF <EXISTS> expected
alter storage if exists
error: ALTER STORAGE <name> expected
alter storage if exists test abc
error: ALTER STORAGE name <RENAME or SET> expected
# test: alter storage rename (already exists)
create storage test
show storages debug
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
alter storage test rename
error: ALTER STORAGE RENAME <name> expected
alter storage test rename to
error: ALTER STORAGE RENAME <name> expected
alter storage test rename to test
error: storage 'test': already exists
alter storage test rename to main
error: storage 'main': already exists
# test: alter storage rename
alter storage test rename to test2
show storages debug
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test2
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
drop storage test2
# test: alter storage rename if exists
alter storage if exists test rename to test2
show storages debug
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
# test: alter storage rename main
alter storage main rename to test
error: storage 'main': main storage cannot be renamed
show storages debug
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
# test: alter storage set
create storage test
alter storage test set
alter storage test set abc
error: unexpected clause at the end of command
alter storage test set (
error: ALTER STORAGE (<name> expected
alter storage test set (sync
error: sync <true/false> expected
alter storage test set (sync,
error: sync <true/false> expected
alter storage test set (sync,)
error: sync <true/false> expected
alter storage test set (sync 123
error: sync <true/false> expected
alter storage test set (sync true,
error: ALTER STORAGE (<name> expected
alter storage test set (sync true,)
error: ALTER STORAGE (<name> expected
alter storage test set (sync false)
show storages debug
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                false
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
alter storage test set (sync true)
show storages debug
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
alter storage test set (sync false, crc true)
show storages debug
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                false
  crc                 true
  compression         
  refresh_wm          41943040
  region_size         131072
close
