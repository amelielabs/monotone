init
set workers to 0
set interval to 10
open
# test: drop storage parsing
drop
error: DROP <STORAGE|PARTITION|PARTITIONS> expected
drop storage
error: DROP STORAGE <name> expected
drop storage if
error: IF <EXISTS> expected
drop storage if 123
error: IF <EXISTS> expected
drop storage if not
error: IF <EXISTS> expected
drop storage if exists
error: DROP STORAGE <name> expected
drop storage if exists 123
error: DROP STORAGE <name> expected
drop storage 123
error: DROP STORAGE <name> expected
# test: drop storage
create storage test
show storages
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions in cloud 0
  rows                0
  rows_cached         0
  size                0 Mb
  size_uncompressed   0 Mb
  size_cached         0 Mb
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         0
  refresh_wm          41943040
  region_size         131072
test
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions in cloud 0
  rows                0
  rows_cached         0
  size                0 Mb
  size_uncompressed   0 Mb
  size_cached         0 Mb
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         0
  refresh_wm          41943040
  region_size         131072
drop storage test
show storages
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions in cloud 0
  rows                0
  rows_cached         0
  size                0 Mb
  size_uncompressed   0 Mb
  size_cached         0 Mb
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         0
  refresh_wm          41943040
  region_size         131072
# test: drop storage (not exists)
drop storage test
error: storage 'test': not exists
# test: drop storage if exists
drop storage if exists test
# test: drop storage main
drop storage main
error: storage 'main': system storage cannot be dropped
# test: create storage (with partition)
create storage test
insert 0
move partition 0 into test
show storages
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions in cloud 0
  rows                0
  rows_cached         0
  size                0 Mb
  size_uncompressed   0 Mb
  size_cached         0 Mb
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         0
  refresh_wm          41943040
  region_size         131072
test
  min                 0
  max                 10
  partitions          1
  partitions in cloud 0
  rows                1
  rows_cached         0
  size                0 Mb
  size_uncompressed   0 Mb
  size_cached         0 Mb
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         0
  refresh_wm          41943040
  region_size         131072
show partitions verbose
main
test
  0
    min         0
    max         10
    storage     test
    cloud       
    refresh     no
    on storage  yes
    on cloud    no
    memtable_a  0 / 0
    memtable_b  0 / 0
    file        208
    index
      size                159
      size_regions        41
      size_regions_origin 41
      regions             1
      rows                1
      lsn                 0
      compression         0
# test: drop storage (with partition)
drop storage test
error: storage 'test': has partitions
drop partition 0
drop storage test
show storages
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions in cloud 0
  rows                0
  rows_cached         0
  size                0 Mb
  size_uncompressed   0 Mb
  size_cached         0 Mb
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         0
  refresh_wm          41943040
  region_size         131072
close
