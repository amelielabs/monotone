init
set workers to 0
set interval to 10
set serial to false
set uuid to '00000000-0000-0000-0000-000000000000'
open
# test: drop storage parsing
drop
error: DROP <STORAGE|PARTITION|PARTITIONS> expected
drop storage
error: DROP STORAGE <name> expected
drop storage if
error: IF <EXISTS> expected
drop storage if 123
error: IF <EXISTS> expected
drop storage if not
error: IF <EXISTS> expected
drop storage if exists
error: DROP STORAGE <name> expected
drop storage if exists 123
error: DROP STORAGE <name> expected
drop storage 123
error: DROP STORAGE <name> expected
# test: drop storage
create storage test
show storages debug
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
drop storage test
show storages debug
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
# test: drop storage (not exists)
drop storage test
error: storage 'test': not exists
# test: drop storage if exists
drop storage if exists test
# test: drop storage main
drop storage main
error: storage 'main': main storage cannot be dropped
# test: create storage (with partition)
create storage test
insert 0
move partition 0 into test
show storages debug
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test
  min                 0
  max                 10
  partitions          1
  partitions_cloud    0
  events              1
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
show partitions verbose
main
test
  0
    min         0
    max         10
    storage     test
    cloud       
    refresh     no
    on storage  yes
    on cloud    no
    memtable_a  0 / 0
    memtable_b  0 / 0
    file        208
    index
      size                159
      size_regions        41
      size_regions_origin 41
      regions             1
      events              1
      lsn                 1
      compression         0
# test: drop storage (with partition)
drop storage test
error: storage 'test': has partitions
drop partition 0
drop storage test
show storages debug
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
close
