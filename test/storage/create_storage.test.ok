init
set workers to 0
set interval to 10
set serial to false
open
# test: main storage created on open
show storages
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
# test: create storage parsing
create
error: CREATE <CLOUD|STORAGE> expected
create storage
error: CREATE STORAGE <name> expected
create storage if
error: IF <NOT> EXISTS expected
create storage if abc
error: IF <NOT> EXISTS expected
create storage if not abc
error: IF NOT <EXISTS> expected
create storage if not exists
error: CREATE STORAGE <name> expected
create storage 123
error: CREATE STORAGE <name> expected
create storage test junk
error: unexpected clause at the end of command
create storage test (
error: CREATE STORAGE (<name> expected
create storage test (123
error: CREATE STORAGE (<name> expected
create storage test (name
error: CREATE STORAGE: unknown option name
create storage test (sync
error: sync <true/false> expected
create storage test (sync int
error: sync <true/false> expected
create storage test (sync false
error: CREATE STORAGE name (...<)> expected
create storage test (sync false,
error: CREATE STORAGE (<name> expected
create storage test (sync false,)
error: CREATE STORAGE (<name> expected
create storage test (sync false, sync false
error: CREATE STORAGE name (...<)> expected
create storage test (sync false, sync false) junk
error: unexpected clause at the end of command
# test: create storage (no options)
create storage test
show storages
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
# test: create storage (exists)
create storage test
error: storage 'test': already exists
# test: create storage if not exists
create storage if not exists test
show storages
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
# test: create storage (with options)
drop storage test
create storage test (sync
error: sync <true/false> expected
create storage test (sync 123
error: sync <true/false> expected
create storage test (sync false)
show storages
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                false
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
drop storage test
create storage test (crc
error: crc <true/false> expected
create storage test (crc 123
error: crc <true/false> expected
create storage test (crc true)
show storages
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 true
  compression         
  refresh_wm          41943040
  region_size         131072
drop storage test
create storage test (refresh_wm
error: refresh_wm <integer> expected
create storage test (refresh_wm false
error: refresh_wm <integer> expected
create storage test (refresh_wm 0)
show storages
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          0
  region_size         131072
drop storage test
create storage test (region_size
error: region_size <integer> expected
create storage test (region_size false
error: region_size <integer> expected
create storage test (region_size 4096)
show storages
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         4096
drop storage test
create storage test (compression
error: compression <string> expected
create storage test (compression false
error: compression <string> expected
create storage test (compression 1)
error: compression <string> expected
create storage test (compression 'none')
show storages
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         none
  refresh_wm          41943040
  region_size         131072
drop storage test
create storage test (path
error: path <string> expected
create storage test (path false
error: path <string> expected
create storage test (path 'on_base')
show storages
main
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                ''
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
test
  min                 18446744073709551615
  max                 0
  partitions          0
  partitions_cloud    0
  events              0
  events_heap         0
  size                0M
  size_uncompressed   0M
  size_heap           0M
  path                'on_base'
  cloud               ''
  sync                true
  crc                 false
  compression         
  refresh_wm          41943040
  region_size         131072
drop storage test
create storage test (cloud
error: cloud <string> expected
create storage test (cloud false
error: cloud <string> expected
create storage test (cloud 'undef')
error: storage 'test': cloud 'undef' does not exists
create storage test (cloud 'mock')
error: storage 'test': cloud 'mock' does not exists
# test: create storage set path
create storage test (path '__dir')
files __dir
drop storage test
close
